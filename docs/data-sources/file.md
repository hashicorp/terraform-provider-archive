---
page_title: "archive_file Data Source - terraform-provider-archive"
subcategory: ""
description: |-
  Generates an archive from content, a file, or directory of files.
---

# archive_file (Data Source)

Generates an archive from content, a file, or directory of files.

## Example Usage

```terraform
# Archive a single file to s3.

terraform {
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "5.19.0"
    }
  }
}

data "archive_file" "example" {
  type        = "zip"
  output_path = "main.zip"
  source_file = "main.py"
}

resource "aws_s3_bucket" "example" {
  bucket = "bad-lambda-layer-bucket"
  tags = {
    "adsk:moniker" = "AMPS-C-UW2"
  }
}

resource "aws_s3_object" "example" {
  bucket = aws_s3_bucket.example.id
  key    = data.archive_file.example.output_path
  source = data.archive_file.example.output_path
}
```

```terraform
# Archive a file to be used with Lambda using consistent file mode

data "archive_file" "example" {
  type             = "zip"
  output_path      = "${path.module}/main.zip"
  output_file_mode = "0666"
  source_file      = "${path.module}/main.py"
}
```

```terraform
# Archive multiple files from a template.

terraform {
  required_providers {
    template = {
      source  = "hashicorp/template"
      version = "2.2.0"
    }
  }
}

data "template_file" "foo" {
  template = file("${path.module}/foo.tpl")
  vars = {
    foo = "bar"
  }
}

data "template_file" "hello" {
  template = file("${path.module}/hello.tpl")
  vars = {
    hello = "world"
  }
}

data "archive_file" "example" {
  type        = "zip"
  output_path = "${path.module}/example.zip"

  source {
    content  = data.template_file.foo.rendered
    filename = "foo.txt"
  }

  source {
    content  = data.template_file.hello.rendered
    filename = "hello.txt"
  }
}
```

```terraform
# Archive a single directory.

data "archive_file" "example" {
  type             = "zip"
  output_path      = "${path.module}/main.zip"
  source_dir       = "${path.module}/dir"
  output_file_mode = "0666"
  excludes         = ["exclude.txt"]
}
```

```terraform
# Archive a single directory as tgz.

data "archive_file" "example" {
  type             = "tgz"
  output_path      = "${path.module}/main.tar.gz"
  source_dir       = "${path.module}/dir"
  output_file_mode = "0400"
  excludes         = ["exclude.txt"]
}
```

```terraform
data "archive_file" "example" {
  type        = "zip"
  output_path = "main.zip"
  source_dir  = "${path.module}/src"
}
```

```terraform
# Archive a single file.

data "archive_file" "example" {
  type             = "zip"
  output_path      = "${path.module}/main.zip"
  output_file_mode = "0666"
  source_file      = "${path.module}/main.txt"
}
```

```terraform
# Archive content.

data "archive_file" "example" {
  type                    = "zip"
  output_path             = "${path.module}/main.zip"
  source_content_filename = "example.txt"
  source_content          = "example"
}
```

```terraform
# Archive content as tgz.

data "archive_file" "example" {
  type                    = "tgz"
  output_path             = "${path.module}/main.tar.gz"
  source_content_filename = "example.txt"
  source_content          = "example"
}
```

```terraform
# Archive a single file as tgz.

data "archive_file" "example" {
  type             = "tgz"
  output_path      = "${path.module}/main.tar.gz"
  output_file_mode = "0400"
  source_file      = "${path.module}/main.txt"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `output_path` (String) The output of the archive file.
- `type` (String) The type of archive to generate. NOTE: `zip, tgz` are supported.

### Optional

- `exclude_symlink_directories` (Boolean) Boolean flag indicating whether symbolically linked directories should be excluded during the creation of the archive. Defaults to `false`.
- `excludes` (Set of String) Specify files to ignore when reading the `source_dir`.
- `output_file_mode` (String) String that specifies the octal file mode for all archived files. For example: `"0666"`. Setting this will ensure that cross platform usage of this module will not vary the modes of archived files (and ultimately checksums) resulting in more deterministic behavior.
- `source` (Block Set) Specifies attributes of a single source file to include into the archive. One and only one of `source`, `source_content_filename` (with `source_content`), `source_file`, or `source_dir` must be specified. (see [below for nested schema](#nestedblock--source))
- `source_content` (String) Add only this content to the archive with `source_content_filename` as the filename. One and only one of `source`, `source_content_filename` (with `source_content`), `source_file`, or `source_dir` must be specified.
- `source_content_filename` (String) Set this as the filename when using `source_content`. One and only one of `source`, `source_content_filename` (with `source_content`), `source_file`, or `source_dir` must be specified.
- `source_dir` (String) Package entire contents of this directory into the archive. One and only one of `source`, `source_content_filename` (with `source_content`), `source_file`, or `source_dir` must be specified.
- `source_file` (String) Package this file into the archive. One and only one of `source`, `source_content_filename` (with `source_content`), `source_file`, or `source_dir` must be specified.

### Read-Only

- `id` (String) The sha1 checksum hash of the output.
- `output_base64sha256` (String) Base64 Encoded SHA256 checksum of output file
- `output_base64sha512` (String) Base64 Encoded SHA512 checksum of output file
- `output_md5` (String) MD5 of output file
- `output_sha` (String) SHA1 checksum of output file
- `output_sha256` (String) SHA256 checksum of output file
- `output_sha512` (String) SHA512 checksum of output file
- `output_size` (Number) The byte size of the output archive file.

<a id="nestedblock--source"></a>
### Nested Schema for `source`

Required:

- `content` (String) Add this content to the archive with `filename` as the filename.
- `filename` (String) Set this as the filename when declaring a `source`.
